---
layout: post
title: 시계열 데이터 다루기1 - 날짜/시각 처리
excerpt: R에서 날짜와 시각을 처리하는 방법에 대해
categories: [jekyll]
tags: #[jekyll, blog, 꿀팁]
last_modified_at: 2022-04-29
---

시계열 데이터란 시간을 기반으로 순서가 매겨진 데이터이다. 시계열 데이터는 날짜/시각 정보가 반드시 포함된다. 따라서 시계열 데이터를 다룰 때에 날짜/시각를 문자형이나 수치형이 아닌 날짜형으로 변환하면 전처리/ 시각화/ 모델링에 편리하게 사용할 수 있다. 

해당 포스트에서는 시계열 데이터 분석/추출할 때 많이 사용하는 프로그램인 통계 프로그램 R에서의 날짜/시각 처리에 대해 정리했다. 

### R에서의 날짜/시각 처리 

R에서는 lubridate라는 패키지만 있으면, 편하게 시계열 데이터를 다룰 수 있다. (사실 lubridate말고도 다양한 날짜 처리 패키지가 있지만, 개인적인 경험으로는 lubridate가 제일 간편하다! 추천은 언제든지 환영)

#### 패키지 불러오기 
```R
# install.packages("lubridate")
library(lubridate)
```

#### 날짜 처리 

`ymd()`는 날짜 처리에 대해 만능인데, 대부분의 날짜 형식에 대해 스마트하게 날짜로 인식해준다. 아래 4개의 다른 형식의 22.4.19를 날짜 형식으로 받아들인다. 
```R
ymd(20220419) # 숫자형
## [1] "2022-04-19"
ymd("20220419") # 문자형
## [1] "2022-04-19"
ymd("220419") # 6자리 숫자형
## [1] "2022-04-19"
ymd("22/4/19") # y/m/d 문자형 
## [1] "2022-04-19"
```

#### 시각 처리 
시각처리도 `ymd_hms()`로 가능하다. 아래와 같이 h(hour/시간), m(min/분), s(sec/초)으로 각 데이터가 어디까지 함유하고 있는지를 바탕으로 초단위까지 시각 처리가 가능하다.
```R
ymd_h("20220419 10") 
#[1] "2022-04-19 10:00:00 UTC"
ymd_hm("20220419 1010") 
#[1] "2022-04-19 10:10:00 UTC"
ymd_hms("20220419 101010") 
#[1] "2022-04-19 10:10:10 UTC"
```
단, `yms_hms()`의 경우는 인풋으로 들어간 값 시/분/초까지 있다면, `ymd_h()`나 `ymd_hm()`를 사용하면 안된다. 무엇이 시간이고 분인지 구분이 되지 않아 값이 출력되지 않는다. 
```R
ymd_hm("20220419 101010") 
#[1] NA
#경고메시지(들): 
#All formats failed to parse. No formats found. 
```
해당 경우에는 형식이 동일하다면, 아래와 같이 필요한 값만 끊어서 쓸 수 있다. 또한 기본 함수인 `as.POSIXct()`를 사용해서 시각 처리 뒤에 `format()`함수를 이용해서 원하는 형식으로 바꿔줄 수도 있다. (날짜/시각 형식 지정자 참고 블로그 : [[R] 문자열 / 날짜 데이터 처리 맛보기](https://velog.io/@yummygyudon/R-%EB%AC%B8%EC%9E%90%EC%97%B4-%EB%82%A0%EC%A7%9C-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%B2%98%EB%A6%AC-%EB%A7%9B%EB%B3%B4%EA%B8%B0-feat.%EC%A0%95%EA%B7%9C%ED%91%9C%ED%98%84%EC%8B%9D))
```R
ymd_hm(substr("20220419 101010",1,13)) 
#[1] "2022-04-19 10:10:00 UTC"
format(as.POSIXct("20220419 101010",format="%Y%m%d %H%M%S"),"%Y-%m-%d %H:%M") # "%Y%m%d %H%M%S" -> "%Y-%m-%d %H:%M"
#[1] "2022-04-19 10:10"
```